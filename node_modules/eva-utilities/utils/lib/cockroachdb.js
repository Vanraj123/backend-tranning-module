const pg = require('pg');

class CockroachDb {
    constructor(options) {
        this.pool = new pg.Pool({
            host: options.host,
            port: options.port,
            user: options.user,
            database: options.db ?? 'sample',
            max: options.maxPoolSize,
            connectionTimeoutMillis: options.timeOutMs,
            idleTimeoutMillis: options.idleTimeOutMs,
        });
    }

    async query(rawQuery, values) {
        return await this.pool.query(rawQuery, values); 
    }
}

module.exports = CockroachDb;